<!-- templates/index.html -->

<!DOCTYPE html>
<html>
<head>
    <title>Status da VM</title>
    <!-- Link para o Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <!-- Link para o Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <!-- Link para o CSS personalizado -->
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body class="bg-light">
    <div class="container">
        <div class="mt-5">
            <h1 class="text-center">Status da VM</h1>
            <p id="status" class="text-center display-4 text-primary">{{ status }}</p>
            <div class="text-center">
                <a id="action-button" href="#" class="btn btn-lg">
                    <i id="action-icon" class=""></i> <span id="action-text"></span>
                </a>
            </div>
        </div>
    </div>
    <!-- Scripts do Bootstrap JS e dependÃªncias -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <!-- Script JavaScript para atualizar o status -->
    <script>
        function updateStatus() {
            fetch('{{ url_for('get_status') }}')
            .then(response => response.json())
            .then(data => {
                document.getElementById('status').innerText = data.status;
                let actionButton = document.getElementById('action-button');
                let actionIcon = document.getElementById('action-icon');
                let actionText = document.getElementById('action-text');
                if (data.status != 'RUNNING') {
                    actionText.innerText = 'Ligar VM';
                    actionButton.href = '{{ url_for('start') }}';
                    actionButton.className = 'btn btn-success btn-lg';
                    actionIcon.className = 'fas fa-play';
                } else {
                    actionText.innerText = 'Desligar VM';
                    actionButton.href = '{{ url_for('stop') }}';
                    actionButton.className = 'btn btn-danger btn-lg';
                    actionIcon.className = 'fas fa-power-off';
                }
            });
        }

        setInterval(updateStatus, 5000);  // Atualiza a cada 5 segundos
        updateStatus();  // Atualiza imediatamente ao carregar
    </script>
</body>
</html>
